(function(e){function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}var t={};return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.n=function(e){var t=e&&e.__esModule?function(){return e['default']}:function(){return e};return n.d(t,'a',t),t},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p='',n(n.s=8)})([function(e,n){'use strict';Object.defineProperty(n,'__esModule',{value:!0});class t{constructor(e,n,t,o){this.type=e,this.lexeme=n,this.literal=t,this.start=o}get end(){return this.start+this.lexeme.length}toString(){return`[${this.type}] ${this.lexeme} ${this.literal}`}static equals(e,n){return e.type===n.type&&e.lexeme===n.lexeme&&e.literal===n.literal&&e.start===n.start}}n.default=t;var o;(function(e){e[e.LEFT_PAREN=0]='LEFT_PAREN',e[e.RIGHT_PAREN=1]='RIGHT_PAREN',e[e.LEFT_BRACE=2]='LEFT_BRACE',e[e.RIGHT_BRACE=3]='RIGHT_BRACE',e[e.COMMA=4]='COMMA',e[e.DOT=5]='DOT',e[e.MINUS=6]='MINUS',e[e.PLUS=7]='PLUS',e[e.SEMI=8]='SEMI',e[e.SLASH=9]='SLASH',e[e.STAR=10]='STAR',e[e.BANG=11]='BANG',e[e.BANG_EQUAL=12]='BANG_EQUAL',e[e.EQUAL=13]='EQUAL',e[e.EQUAL_EQUAL=14]='EQUAL_EQUAL',e[e.GREATER=15]='GREATER',e[e.GREATE_EQUAL=16]='GREATE_EQUAL',e[e.LESS=17]='LESS',e[e.LESS_EQUAL=18]='LESS_EQUAL',e[e.IDENTIFIER=19]='IDENTIFIER',e[e.STRING=20]='STRING',e[e.NUMBER=21]='NUMBER',e[e.AND=22]='AND',e[e.CLASS=23]='CLASS',e[e.ELSE=24]='ELSE',e[e.FALSE=25]='FALSE',e[e.FUN=26]='FUN',e[e.FOR=27]='FOR',e[e.IF=28]='IF',e[e.NIL=29]='NIL',e[e.OR=30]='OR',e[e.PRINT=31]='PRINT',e[e.RETURN=32]='RETURN',e[e.SUPER=33]='SUPER',e[e.THIS=34]='THIS',e[e.TRUE=35]='TRUE',e[e.VAR=36]='VAR',e[e.WHILE=37]='WHILE',e[e.BREAK=38]='BREAK',e[e.EOF=39]='EOF'})(o=n.TokenType||(n.TokenType={}))},function(e,n,t){'use strict';Object.defineProperty(n,'__esModule',{value:!0});const o=t(0),r=t(7),a=t(17),i=t(18);class s extends Error{constructor(e,n){super(n),this.token=e}}n.RuntimeException=s;class l extends Error{}class p extends Error{constructor(e){super(),this.value=e}}n.ReturnException=p;n.default=class{constructor(e){this.locals=new Map,this.globals=new r.default,this.evironment=this.globals,this.runner=e,this.globals.define('clock',new class extends a.LoxCallable{constructor(){super(...arguments),this.arity=0}call(){return Date.now()}})}interpret(e){try{for(let n of e)this.execute(n)}catch(e){e instanceof s&&this.runner.runtimeError(e)}}execute(e){e.accept(this)}visitFunctionStmt(e){const n=new a.LoxFunction(e.name.lexeme,e.fn,this.evironment,!1);this.evironment.define(e.name.lexeme,n)}visitFunctionExpr(e){return new a.LoxFunction(void 0,e,this.evironment,!1)}visitReturnStmt(e){let n;throw null!==e.value&&(n=this.evaluate(e.value)),new p(n)}visitVarStmt(e){let n=null;null!=e.initializer&&(n=this.evaluate(e.initializer)),this.evironment.define(e.name.lexeme,n)}visitVariableExpr(e){return this.lookupVariable(e.name,e)}visitClassStmt(e){this.evironment.define(e.name.lexeme,null);const n={};for(let t of e.classMethods)n[t.name.lexeme]=new a.LoxFunction(t.name.lexeme,t.fn,this.evironment,!1);const t=new i.LoxClass(null,`${e.name.lexeme}meta`,n),o={};for(let n of e.methods)o[n.name.lexeme]=new a.LoxFunction(n.name.lexeme,n.fn,this.evironment,'init'===n.name.lexeme);const r=new i.LoxClass(t,e.name.lexeme,o);this.evironment.assign(e.name,r)}visitThisExpr(e){return this.lookupVariable(e.keyword,e)}visitExpressionStmt(e){this.evaluate(e.expr)}visitPrintStmt(e){const n=this.evaluate(e.expr);this.runner.logger.log(n.toString())}visitBlockStmt(e){this.executeBlock(e,new r.default(this.evironment))}visitIfStmt(e){this.isTruthy(this.evaluate(e.condition))?this.execute(e.thenBranch):e.elseBranch&&this.execute(e.elseBranch)}visitWhileStmt(e){try{for(;this.isTruthy(this.evaluate(e.condition));)this.execute(e.body)}catch(e){if(e instanceof l)return;throw e}}visitBreakStmt(){throw new l}visitLogicalExpr(e){const n=this.evaluate(e.left);if(e.operator.type===o.TokenType.OR){if(this.isTruthy(n))return n;}else if(!this.isTruthy(n))return n;return this.evaluate(e.right)}visitAssignExpr(e){const n=this.evaluate(e.value),t=this.locals.get(e);return void 0===t?this.globals.assign(e.name,n):this.evironment.assignAt(t,e.name,n),n}visitLiteralExpr(e){return e.value}visitGroupingExpr(e){return this.evaluate(e.expr)}visitUnaryExpr(e){const n=this.evaluate(e.right);switch(e.operation.type){case o.TokenType.MINUS:return-n;case o.TokenType.BANG:return!this.isTruthy(n);}return null}visitCallExpr(e){const n=this.evaluate(e.callee);if(!(n instanceof a.LoxCallable)&&!(n instanceof i.LoxClass))throw new s(e.paren,'Can only call function and class methods.');const t=e.args.map((e)=>this.evaluate(e));if(t.length!==n.arity)throw new s(e.paren,`Expected ${n.arity} arguments but got ${t.length}.`);return n.call(this,t)}visitGetExpr(e){const n=this.evaluate(e.object);if(n instanceof i.LoxInstance)return n.get(e.name);throw new s(e.name,'Only instances have properties.')}visitSetExpr(e){const n=this.evaluate(e.object);if(!(n instanceof i.LoxInstance))throw new s(e.name,'Only instances have fields.');const t=this.evaluate(e.value);return n.set(e.name,t),t}visitBinaryExpr(e){const n=this.evaluate(e.left),t=this.evaluate(e.right);switch(e.operator.type){case o.TokenType.PLUS:if('string'==typeof n||'string'==typeof t)return n+''+(t+'');if('number'==typeof n&&'number'==typeof t)return n+t;throw new s(e.operator,'Operands must be 2 strings or numbers');case o.TokenType.MINUS:return this.checkNumberOperands(e.operator,n,t),n-t;case o.TokenType.SLASH:return this.checkNumberOperands(e.operator,n,t),n/t;case o.TokenType.STAR:return this.checkNumberOperands(e.operator,n,t),n*t;case o.TokenType.GREATER:return this.checkNumberOperands(e.operator,n,t),n>t;case o.TokenType.GREATE_EQUAL:return this.checkNumberOperands(e.operator,n,t),n>=t;case o.TokenType.LESS:return this.checkNumberOperands(e.operator,n,t),n<t;case o.TokenType.LESS_EQUAL:return this.checkNumberOperands(e.operator,n,t),n<=t;case o.TokenType.BANG_EQUAL:return!this.isEqual(n,t);case o.TokenType.EQUAL_EQUAL:return this.isEqual(n,t);}return null}executeBlock(e,n){const t=this.evironment;try{this.evironment=n;for(let n of e.statements)this.execute(n)}finally{this.evironment=t}}evaluate(e){return e.accept(this)}resolve(e,n){this.locals.set(e,n)}lookupVariable(e,n){const t=this.locals.get(n);return void 0===t?this.globals.get(e):this.evironment.getAt(t,e.lexeme)}isTruthy(e){return'boolean'==typeof e?e:null!=e}isEqual(e,n){return!(typeof e!=typeof n)&&e==n}checkNumberOperand(e,n){if('number'!=typeof n)throw new s(e,'Operand must be a number')}checkNumberOperands(e,n,t){if('number'!=typeof n&&'number'!=typeof t)throw new s(e,'Operands must be 2 numbers')}}},function(e,n,t){'use strict';function o(e){return'0'<=e&&'9'>=e}function r(e){return'a'<=e&&'z'>=e||'A'<=e&&'Z'>=e}function a(e){return r(e)||o(e)}Object.defineProperty(n,'__esModule',{value:!0});const i=t(0);n.KEYWORDS=new Map([['and',i.TokenType.AND],['class',i.TokenType.CLASS],['else',i.TokenType.ELSE],['false',i.TokenType.FALSE],['for',i.TokenType.FOR],['if',i.TokenType.IF],['nil',i.TokenType.NIL],['or',i.TokenType.OR],['print',i.TokenType.PRINT],['return',i.TokenType.RETURN],['super',i.TokenType.SUPER],['this',i.TokenType.THIS],['true',i.TokenType.TRUE],['var',i.TokenType.VAR],['while',i.TokenType.WHILE],['break',i.TokenType.BREAK],['fun',i.TokenType.FUN]]);n.default=class{constructor(e,n){this.source=e,this.config=n,this.tokens=[],this.start=0,this.current=0}scanTokens(){for(;!this.isAtEnd();)this.start=this.current,this.scanToken();return this.tokens.push(new i.default(i.TokenType.EOF,'',null,this.start)),this.tokens}isAtEnd(){return this.current>=this.source.length}advance(){return this.source.charAt(this.current++)}match(e){return!this.isAtEnd()&&this.source.charAt(this.current)===e&&(this.current++,!0)}peek(){return this.isAtEnd()?'\0':this.source.charAt(this.current)}peekNext(){return this.current+1>=this.source.length?'\0':this.source.charAt(this.current+1)}addToken(e,n=null){const t=this.source.slice(this.start,this.current);this.tokens.push(new i.default(e,t,n,this.start))}scanToken(){const e=this.advance();switch(e){case'(':this.addToken(i.TokenType.LEFT_PAREN);break;case')':this.addToken(i.TokenType.RIGHT_PAREN);break;case'{':this.addToken(i.TokenType.LEFT_BRACE);break;case'}':this.addToken(i.TokenType.RIGHT_BRACE);break;case',':this.addToken(i.TokenType.COMMA);break;case'.':this.addToken(i.TokenType.DOT);break;case'.':this.addToken(i.TokenType.DOT);break;case'-':this.addToken(i.TokenType.MINUS);break;case'+':this.addToken(i.TokenType.PLUS);break;case';':this.addToken(i.TokenType.SEMI);break;case'*':this.addToken(i.TokenType.STAR);break;case'!':this.addToken(this.match('=')?i.TokenType.BANG_EQUAL:i.TokenType.BANG);break;case'=':this.addToken(this.match('=')?i.TokenType.EQUAL_EQUAL:i.TokenType.EQUAL);break;case'<':this.addToken(this.match('=')?i.TokenType.LESS_EQUAL:i.TokenType.LESS);break;case'>':this.addToken(this.match('=')?i.TokenType.GREATE_EQUAL:i.TokenType.GREATER);break;case'/':if(this.match('/'))for(;'\n'!==this.peek()&&!this.isAtEnd();)this.advance();else if(this.match('*')){for(;'*'!==this.peek()&&'/'!==this.peekNext()&&!this.isAtEnd();)this.advance();'/'!==this.peek()&&(this.advance(),this.advance())}else this.addToken(i.TokenType.SLASH);break;case' ':case'\r':case'\t':case'\n':break;case'"':this.string();break;default:o(e)?this.number():r(e)?this.identifier():this.config.error(this.current,`Unexpected character ${e}`);}}string(){for(;'"'!==this.peek()&&!this.isAtEnd();)this.advance();if(this.isAtEnd())return void this.config.error(this.current,'Unterminated string.');this.advance();const e=this.source.slice(this.start+1,this.current-1);this.addToken(i.TokenType.STRING,e)}number(){for(;o(this.peek());)this.advance();let e=!1;if('.'===this.peek()&&o(this.peekNext()))for(this.advance(),e=!0;o(this.peek());)this.advance();const n=this.source.slice(this.start,this.current),t=e?parseFloat(n):parseFloat(n);this.addToken(i.TokenType.NUMBER,t)}identifier(){for(;a(this.peek());)this.advance();const e=this.source.slice(this.start,this.current);let t=n.KEYWORDS.get(e);null==t&&(t=i.TokenType.IDENTIFIER),this.addToken(t)}}},function(e,n){'use strict';Object.defineProperty(n,'__esModule',{value:!0});class t{}n.Stmt=t;n.Block=class extends t{constructor(e){super(),this.statements=e}accept(e){return e.visitBlockStmt(this)}};n.Expression=class extends t{constructor(e){super(),this.expr=e}accept(e){return e.visitExpressionStmt(this)}};n.Class=class extends t{constructor(e,n,t){super(),this.name=e,this.methods=n,this.classMethods=t}accept(e){return e.visitClassStmt(this)}};n.If=class extends t{constructor(e,n,t){super(),this.condition=e,this.thenBranch=n,this.elseBranch=t}accept(e){return e.visitIfStmt(this)}};n.While=class extends t{constructor(e,n){super(),this.condition=e,this.body=n}accept(e){return e.visitWhileStmt(this)}};n.Break=class extends t{constructor(){super()}accept(e){return e.visitBreakStmt(this)}};n.Print=class extends t{constructor(e){super(),this.expr=e}accept(e){return e.visitPrintStmt(this)}};n.Var=class extends t{constructor(e,n){super(),this.name=e,this.initializer=n}accept(e){return e.visitVarStmt(this)}};n.Function=class extends t{constructor(e,n){super(),this.name=e,this.fn=n}accept(e){return e.visitFunctionStmt(this)}};n.Return=class extends t{constructor(e,n){super(),this.keyword=e,this.value=n}accept(e){return e.visitReturnStmt(this)}}},function(e,n,t){'use strict';Object.defineProperty(n,'__esModule',{value:!0});const o=t(2);n.KEYWORDS=Array.from(o.KEYWORDS.keys()),n.MONARCH_TOKEN_PROVIDER={ignoreCase:!0,keywords:n.KEYWORDS,operators:['=','>','<','!','?',':','==','<=','>=','!='],tokenizer:{root:[[/[a-zA-Z][a-zA-Z0-9]*/,{cases:{"@keywords":'keyword',"@default":'identifier'}}],[/\/\*/,'comment','@comment'],[/\/\/.*/,'comment'],[/"/,'string','@string'],[/\d+\.\d+/,'number.float'],[/\d+/,'number']],comment:[[/[^\/*]+/,'comment'],['\\*/','comment','@pop']],string:[[/[^"]+/,'string'],[/"/,'string','@pop']]}}},function(e,n,t){'use strict';function o(e,n){function t(e,n){return e.start<=n&&n<e.end}function o(e,n){return{line:r+e.line,column:a+n-e.start,character:n}}void 0===n&&(n={});var r=n.offsetLine||0,a=n.offsetColumn||0,s=e.split('\n'),l=0,p=s.map(function(e,n){var t=l+e.length+1,o={start:l,end:t,line:n};return l=t,o}),c=0;return function(n,r){'string'==typeof n&&(n=e.indexOf(n,r||0));for(var a=p[c],i=n>=a.end?1:-1;a;){if(t(a,n))return o(a,n);c+=i,a=p[c]}}}function r(e,n,t){if('number'==typeof t)throw new Error('locate takes a { startIndex, offsetLine, offsetColumn } object as the third argument');return o(e,t)(n,t&&t.startIndex)}Object.defineProperty(n,'__esModule',{value:!0}),t.d(n,'getLocator',function(){return o}),t.d(n,'locate',function(){return r})},function(e,n,t){'use strict';Object.defineProperty(n,'__esModule',{value:!0});const o=t(0),r=t(3),a=t(15),i=t(3);class s extends Error{}n.default=class{constructor(e,n){this.tokens=e,this.config=n,this.current=0,this.loopDepth=0}parse(){const e=[];for(;!this.isAtEnd();){const n=this.declaration();n&&e.push(n)}return e}declaration(){try{return this.match(o.TokenType.FUN)?this.function('function'):this.match(o.TokenType.VAR)?this.varDeclaration():this.match(o.TokenType.CLASS)?this.classDeclaration():this.statement()}catch(e){e instanceof s&&this.synchronize()}}function(e){const n=this.consume(o.TokenType.IDENTIFIER,`Expected ${e} name.`),t=this.functionBody(e);return new r.Function(n,t)}functionBody(e){this.consume(o.TokenType.LEFT_PAREN,`Expected "(" after ${e} name.`);const n=[];if(!this.check(o.TokenType.RIGHT_PAREN))do 8<=n.length&&this.error(this.peek(),'Cannot have more than 8 parameters.'),n.push(this.consume(o.TokenType.IDENTIFIER,'Expected parameter name.'));while(this.match(o.TokenType.COMMA));this.consume(o.TokenType.RIGHT_PAREN,'Expected ")" after parameters.'),this.consume(o.TokenType.LEFT_BRACE,`Expected "{" before ${e} body.`);const t=this.block();return new a.Function(n,t)}classDeclaration(){const e=this.consume(o.TokenType.IDENTIFIER,'Expected a name for the class.');this.consume(o.TokenType.LEFT_BRACE,'Expected "{" after class name.');const n=[],t=[];for(;!this.isAtEnd()&&!this.check(o.TokenType.RIGHT_BRACE);){const e=this.match(o.TokenType.CLASS);(e?t:n).push(this.function('method'))}return this.consume(o.TokenType.RIGHT_BRACE,'Expected "}" after class.'),new i.Class(e,n,t)}varDeclaration(){const e=this.consume(o.TokenType.IDENTIFIER,'Expected a variable name');let n=this.match(o.TokenType.EQUAL)?this.expression():new a.Literal(null);return this.consume(o.TokenType.SEMI,'Expected ";" after variable declaration'),new r.Var(e,n)}statement(){return this.match(o.TokenType.PRINT)?this.printStatement():this.match(o.TokenType.LEFT_BRACE)?new r.Block(this.block()):this.match(o.TokenType.IF)?this.ifStatement():this.match(o.TokenType.WHILE)?this.whileStatement():this.match(o.TokenType.FOR)?this.forStatement():this.match(o.TokenType.BREAK)?this.breakStatement():this.match(o.TokenType.RETURN)?this.returnStatement():this.expressionStatement()}ifStatement(){this.consume(o.TokenType.LEFT_PAREN,'Expected "(" after "if".');const e=this.expression();this.consume(o.TokenType.RIGHT_PAREN,'Expected ")" after if condition.');const n=this.statement();let t;return this.match(o.TokenType.ELSE)&&(t=this.statement()),new r.If(e,n,t)}whileStatement(){this.consume(o.TokenType.LEFT_PAREN,'Expected "(" after "while".');const e=this.expression();this.consume(o.TokenType.RIGHT_PAREN,'Expected ")" after while condition.');try{this.loopDepth++;const n=this.statement();return new r.While(e,n)}finally{this.loopDepth--}}forStatement(){this.consume(o.TokenType.LEFT_PAREN,'Expeceted "(" after "for".');let e=this.match(o.TokenType.SEMI)?void 0:this.match(o.TokenType.VAR)?this.varDeclaration():this.expressionStatement();let n;this.check(o.TokenType.SEMI)||(n=this.expression()),this.consume(o.TokenType.SEMI,'Expected ";" after for condition.');let t;this.check(o.TokenType.RIGHT_PAREN)||(t=this.expression()),this.consume(o.TokenType.RIGHT_PAREN,'Expected ")" after for clauses.');try{this.loopDepth++;let o=this.statement();return t&&(o=new r.Block([o,new r.Expression(t)])),n||(n=new a.Literal(!0)),o=new r.While(n,o),e&&(o=new r.Block([e,o])),o}finally{this.loopDepth--}}breakStatement(){return 0>=this.loopDepth&&this.error(this.previous(),'Must be inside a loop to use "break".'),this.consume(o.TokenType.SEMI,'Expected ";" after "break".'),new r.Break}returnStatement(){const e=this.previous();let n=new a.Literal(null);return this.check(o.TokenType.SEMI)||(n=this.expression()),this.consume(o.TokenType.SEMI,'Expected ";" after return value.'),new r.Return(e,n)}printStatement(){const e=this.expression();return this.consume(o.TokenType.SEMI,'Expected ";" at the end of the expression.'),new r.Print(e)}expressionStatement(){const e=this.expression();return this.consume(o.TokenType.SEMI,'Expected ";" at the end of the expression.'),new r.Expression(e)}block(){const e=[];for(;!this.check(o.TokenType.RIGHT_BRACE)&&!this.isAtEnd();){const n=this.declaration();n&&e.push(n)}return this.consume(o.TokenType.RIGHT_BRACE,'Expected "}" after block.'),e}expression(){return this.assignment()}assignment(){const e=this.or();if(this.match(o.TokenType.EQUAL)){const n=this.previous(),t=this.assignment();if(e instanceof a.Variable)return new a.Assign(e.name,t);if(e instanceof a.Get)return new a.Set(e.object,e.name,t);this.error(n,'Invalid assignment target.')}return e}or(){let e=this.and();for(;this.match(o.TokenType.OR)&&!this.isAtEnd();){const n=this.previous(),t=this.and();e=new a.Logical(e,n,t)}return e}and(){let e=this.equality();for(;this.match(o.TokenType.AND)&&!this.isAtEnd();){const n=this.previous(),t=this.and();e=new a.Logical(e,n,t)}return e}coma(){let e=this.equality();for(;this.match(o.TokenType.COMMA);){const n=this.previous(),t=this.equality();e=new a.Binary(e,n,t)}return e}equality(){let e=this.comparison();for(;this.match(o.TokenType.BANG_EQUAL,o.TokenType.EQUAL_EQUAL);){const n=this.previous(),t=this.comparison();e=new a.Binary(e,n,t)}return e}comparison(){let e=this.addition();for(;this.match(o.TokenType.GREATER,o.TokenType.GREATE_EQUAL,o.TokenType.LESS,o.TokenType.LESS_EQUAL);){const n=this.previous(),t=this.addition();e=new a.Binary(e,n,t)}return e}addition(){let e=this.multiplication();for(;this.match(o.TokenType.PLUS,o.TokenType.MINUS);){const n=this.previous(),t=this.multiplication();e=new a.Binary(e,n,t)}return e}multiplication(){let e=this.unary();for(;this.match(o.TokenType.SLASH,o.TokenType.STAR);){const n=this.previous(),t=this.multiplication();e=new a.Binary(e,n,t)}return e}unary(){if(this.match(o.TokenType.BANG,o.TokenType.MINUS)){const e=this.previous(),n=this.unary();return new a.Unary(e,n)}return this.call()}call(){let e=this.primary();for(;;)if(this.match(o.TokenType.LEFT_PAREN))e=this.finishCall(e);else if(this.match(o.TokenType.DOT)){const n=this.consume(o.TokenType.IDENTIFIER,'Expected property name after ".".');e=new a.Get(e,n)}else break;return e}finishCall(e){const n=[];if(!this.check(o.TokenType.RIGHT_PAREN))do 8<n.length&&this.error(this.peek(),'Cannot have more than 8 arguments.'),n.push(this.expression());while(this.match(o.TokenType.COMMA));const t=this.consume(o.TokenType.RIGHT_PAREN,'Expected ")" after arguments.');return new a.Call(e,t,n)}primary(){if(this.match(o.TokenType.FALSE))return new a.Literal(!1);if(this.match(o.TokenType.TRUE))return new a.Literal(!0);if(this.match(o.TokenType.NIL))return new a.Literal(null);if(this.match(o.TokenType.NUMBER,o.TokenType.STRING))return new a.Literal(this.previous().literal);if(this.match(o.TokenType.LEFT_PAREN)){let e=this.expression();return this.consume(o.TokenType.RIGHT_PAREN,`Expected ')' after expression.`),new a.Grouping(e)}if(this.match(o.TokenType.IDENTIFIER))return new a.Variable(this.previous());if(this.match(o.TokenType.FUN))return this.functionBody('function');if(this.match(o.TokenType.THIS))return new a.This(this.previous());throw this.error(this.peek(),'Expected expression')}match(...e){for(let n of e)if(this.check(n))return this.advance(),!0;return!1}check(e){return!this.isAtEnd()&&this.peek().type===e}advance(){return this.isAtEnd()||this.current++,this.previous()}isAtEnd(){return this.peek().type===o.TokenType.EOF}peek(){return this.tokens[this.current]}previous(){return this.tokens[this.current-1]}consume(e,n){if(this.check(e))return this.advance();throw this.error(this.peek(),n)}synchronize(){for(this.advance();!this.isAtEnd();){switch(this.peek().type){case o.TokenType.CLASS:case o.TokenType.FUN:case o.TokenType.VAR:case o.TokenType.FOR:case o.TokenType.IF:case o.TokenType.WHILE:case o.TokenType.PRINT:case o.TokenType.RETURN:return;}this.advance()}}error(e,n){return this.config.error(e,n),new s}}},function(e,n,t){'use strict';Object.defineProperty(n,'__esModule',{value:!0});const o=t(1);n.default=class{constructor(e){this.values=new Map,this.enclosing=e}define(e,n){this.values.set(e,n)}assign(e,n){if(this.values.has(e.lexeme))this.values.set(e.lexeme,n);else if(this.enclosing)this.enclosing.assign(e,n);else throw new o.RuntimeException(e,`Undefined variable for "${e.lexeme}".`)}assignAt(e,n,t){return this.ancestor(e).values.set(n.lexeme,t)}get(e){if(this.values.has(e.lexeme))return this.values.get(e.lexeme);if(this.enclosing)return this.enclosing.get(e);throw new o.RuntimeException(e,`Undefined variable for "${e.lexeme}".`)}getAt(e,n){return this.ancestor(e).values.get(n)}ancestor(e){return 0===e?this:this.enclosing.ancestor(e-1)}}},function(e,n,t){'use strict';Object.defineProperty(n,'__esModule',{value:!0});const o=t(9),r=t(10),a=t(11),i=t(16);const s=document.querySelector('#preset-select'),l=document.querySelector('#save-button'),p=document.querySelector('#run-button'),c=document.querySelector('#left-container'),u=document.querySelector('#right-container');for(let{name:o,content:a}of r.examples){const e=document.createElement('option');e.text=o,e.value=a,s.appendChild(e)}let d,T;const m=new class{constructor(e){window.addEventListener('popstate',async()=>{const n=await this.load();e.onchange(n||'')})}async load(){const e=new URL(window.location.href),n=new URLSearchParams(e.search);if(n.has('id'))return o.loadGist(n.get('id'))}async save(e){const n=await o.saveGist(e);return history.pushState({},document.title,`?id=${n}`),n}}({onchange(e){d.setValue(e)}});Promise.all([function(){return new Promise((e)=>{window.require.config({paths:{vs:'monaco-editor'}}),window.require(['vs/editor/editor.main'],()=>{e(window.monaco)})})}(),m.load()]).then(([e,n])=>{a.registerLanguage(e),d=e.editor.create(c,{value:n||s.value,language:a.id}),a.registerEditor(e,d),T=e.editor.create(u,{value:'',lineNumbers:!1,scrollBeyondLastLine:!1,readOnly:!0,contextmenu:!1,hideCursorInOverviewRuler:!0,minimap:{enabled:!1},theme:'vs-dark'}),window.addEventListener('resize',()=>{d.layout(),T.layout()}),s.addEventListener('change',()=>{d.setValue(s.value)}),l.addEventListener('click',()=>{m.save(d.getValue())}),p.addEventListener('click',()=>{const e=d.getValue(),n=[],t=function(e){n.push(e),T.setValue(n.join('\n'))},o=new i.default({debug(e){console.debug(e),t(`🔎 ${e}`)},log(e){console.log(e),t(`  ${e}`)},warning(e){console.warn(e),t(`⚠️ ${e}`)},error(e){console.error(e),t(`️❌ ${e}`)}});o.run(e)}),document.body.classList.add('ready')})},function(e,n){'use strict';Object.defineProperty(n,'__esModule',{value:!0});const t='https://api.github.com',o='main.lox',r=`Created by https://pmdartus.github.io/tlox/`;n.saveGist=async function(e){const n=await fetch(`${t}/gists`,{method:'POST',body:JSON.stringify({description:r,public:!0,files:{[o]:{content:e}}})}),a=await n.json();if(!n.ok)throw new Error(a.message);return a.id},n.loadGist=async function(e){const n=await fetch(`${t}/gists/${e}`),r=await n.json();if(!n.ok)throw new Error(r.message);return r.files[o].content}},function(e,n){'use strict';Object.defineProperty(n,'__esModule',{value:!0}),n.examples=[{name:'Hello world!',content:'// Print with the "print" keyword\nprint "Hello World!";'},{name:'Expressions',content:'// Some basic arithmetic works as you\'d expect.\nprint 1 + 1; // = 2\nprint 0.1 + 0.2; // = 0.3\nprint 8 - 1; // = 7\nprint 10 * 2; // = 20\nprint 35 / 5; // = 7\n\n// Negation uses the ! symbol\nprint !true; // = false\nprint !false; // = true\n\n// Equality is ===\nprint 1 == 1; // = true\nprint 2 == 1; // = false\n\n// Inequality is !==\nprint 1 != 1; // = false\nprint 2 != 1; // = true\n\n// More comparisons\nprint 1 < 10; // = true\nprint 1 > 10; // = false\nprint 2 <= 2; // = true\nprint 2 >= 2; // = true\n\n// Strings are concatenated with +\nprint "Hello " + "world!"; // = "Hello world!"\nprint "1, 2, " + 3; // = "1, 2, 3"'},{name:'Flow Control',content:'// The `if` structure works as you\'d expect\nvar condition = true;\nif (condition) {\n    print "yes";\n} else {\n    print "no";\n}\n\n// As does `while`\nvar a = 1;\nwhile (a < 10) {\n    print "While " + a;\n    a = a + 1;\n}\n\n// The `for` loop is the same as C and Java:\n// initialization; continue condition; iteration.\nfor (var a = 1; a < 10; a = a + 1) {\n    print "For " + a;\n}'},{name:'Function',content:'// Functions are defined with the "fun" keyword\nfun fibonacci(n) {\n    if (n <= 1) return n;\n    return fibonacci(n - 2) + fibonacci(n - 1);\n}\n\nfor (var i = 0; i < 10; i = i + 1) {\n    print "Fibonacci " + fibonacci(i);\n}\n\nfun makeClosure() {\n    var i = 0;\n    \n    // You can define a closure into another function\n    fun count() {\n        i = i + 1;\n        return i;\n    }\n\n   return count;\n}\n\nvar counter = makeClosure();\nfor (var i = 0; i < 10; i = i + 1) {\n    print "Closure " + counter();\n}'},{name:'Classes',content:'// Class definition\nclass Rectangle {\n    // Contructor\n    init(height, width) {\n        this.height = height;\n        this.width = width;\n    }\n\n    // Method\n    calcArea() {\n        return this.height * this.width;\n    }\n\n    // Static methods\n    class equals(a, b) {\n        return a.height == b.height and a.width == b.width;\n    }\n}\n\nvar square = Rectangle(10, 10);\nprint "Area: " + square.calcArea();\n\nvar anotherSquare = Rectangle(10, 10);\nprint "Equals? " + Rectangle.equals(square, anotherSquare);'}]},function(e,n,t){'use strict';Object.defineProperty(n,'__esModule',{value:!0});const o=t(12),r=t(4),a=t(13),i=t(14);n.id=o.LANGUAGE_ID,n.registerLanguage=function(e){const{languages:t}=e;t.register({id:n.id}),t.setLanguageConfiguration(n.id,o.LANGUAGE_CONFIG),t.setMonarchTokensProvider(n.id,r.MONARCH_TOKEN_PROVIDER),t.registerCompletionItemProvider(n.id,a.completionItemProvider(e))},n.registerEditor=function(e,n){const t=n.getModel(),o=()=>{const n=t.getValue(),{errors:o}=i.parse(n);e.editor.setModelMarkers(t,'lox',o)};o(),n.onDidChangeModelContent(o)}},function(e,n){'use strict';Object.defineProperty(n,'__esModule',{value:!0}),n.LANGUAGE_ID='lox',n.LANGUAGE_CONFIG={comments:{lineComment:'//',blockComment:['/*','*/']},brackets:[['{','}'],['(',')']],autoClosingPairs:[{open:'{',close:'}'},{open:'(',close:')'},{open:'"',close:'"',notIn:['string']},{open:'/*',close:' */',notIn:['string']}],surroundingPairs:[['{','}'],['(',')'],['"','"']]}},function(e,n,t){'use strict';Object.defineProperty(n,'__esModule',{value:!0});const o=t(4);n.completionItemProvider=function(e){const{CompletionItemKind:n}=e.languages,t=o.KEYWORDS.map((e)=>({label:e,kind:n.Text})),r=[{label:'print',documentation:'Print statement',kind:n.Snippet,insertText:{value:'print $1;'}},{label:'fun',documentation:'Function Statement',kind:n.Snippet,insertText:{value:'fun ${1:name} (${2:params}) {\n\t$3\n}'}},{label:'class',documentation:'Class Statement',kind:n.Snippet,insertText:{value:'class ${1:Name} {\n\tinit(${2:params}) {\n\t\t$3\n\t}\n}'}},{label:'if',documentation:'If Statement',kind:n.Snippet,insertText:{value:'if (${1:cond}) {\n\t$2\n}'}},{label:'ifelse',documentation:'If/Else Statement',kind:n.Snippet,insertText:{value:'if (${1:cond}) {\n\t$2\n} else {\n\t$3\n}'}},{label:'for',documentation:'For Loop',kind:n.Snippet,insertText:{value:'for (var ${1:i} = 0; $1 < ${2:10}; $1 = $1 + 1) {\n\t$0\n}'}},{label:'while',documentation:'While Loop',kind:n.Snippet,insertText:{value:'while (${1:true}) {\n\t$2\n}'}}];return{provideCompletionItems(){return[...t,...r]}}}},function(e,n,t){'use strict';Object.defineProperty(n,'__esModule',{value:!0});const o=t(5),r=t(2),a=t(6);var i;(function(e){e[e.Ignore=0]='Ignore',e[e.Info=1]='Info',e[e.Warning=2]='Warning',e[e.Error=3]='Error'})(i||(i={}));const s={offsetLine:1,offsetColumn:1};n.parse=function(e){const n=o.getLocator(e,s),t=[],l=new r.default(e,{error(e,o){const{line:r,column:a}=n(e);t.push({message:o,startLineNumber:r,endLineNumber:r,startColumn:a,endColumn:a,severity:i.Error})}}),p=l.scanTokens();if(t.length)return{errors:t};const c=new a.default(p,{error(e,o){const r=n(e.start),a=n(e.end);t.push({message:o,startLineNumber:r.line,endLineNumber:a.line,startColumn:r.column,endColumn:a.column,severity:i.Error})}}),u=c.parse();return{errors:t,statements:u}}},function(e,n){'use strict';Object.defineProperty(n,'__esModule',{value:!0});class t{}n.Expr=t;n.Assign=class extends t{constructor(e,n){super(),this.name=e,this.value=n}accept(e){return e.visitAssignExpr(this)}};n.Binary=class extends t{constructor(e,n,t){super(),this.left=e,this.operator=n,this.right=t}accept(e){return e.visitBinaryExpr(this)}};n.Grouping=class extends t{constructor(e){super(),this.expr=e}accept(e){return e.visitGroupingExpr(this)}};n.Literal=class extends t{constructor(e){super(),this.value=e}accept(e){return e.visitLiteralExpr(this)}};n.Unary=class extends t{constructor(e,n){super(),this.operation=e,this.right=n}accept(e){return e.visitUnaryExpr(this)}};n.Call=class extends t{constructor(e,n,t){super(),this.callee=e,this.paren=n,this.args=t}accept(e){return e.visitCallExpr(this)}};n.Get=class extends t{constructor(e,n){super(),this.object=e,this.name=n}accept(e){return e.visitGetExpr(this)}};n.Set=class extends t{constructor(e,n,t){super(),this.object=e,this.name=n,this.value=t}accept(e){return e.visitSetExpr(this)}};n.This=class extends t{constructor(e){super(),this.keyword=e}accept(e){return e.visitThisExpr(this)}};n.Logical=class extends t{constructor(e,n,t){super(),this.left=e,this.operator=n,this.right=t}accept(e){return e.visitLogicalExpr(this)}};n.Variable=class extends t{constructor(e){super(),this.name=e}accept(e){return e.visitVariableExpr(this)}};n.Function=class extends t{constructor(e,n){super(),this.parameter=e,this.body=n}accept(e){return e.visitFunctionExpr(this)}}},function(e,n,t){'use strict';Object.defineProperty(n,'__esModule',{value:!0});const o=t(5),r=t(6),a=t(2),i=t(0),s=t(1),l=t(19),p={offsetLine:1};n.default=class{constructor(e){this.hadError=!1,this.hadRuntimeError=!1,this.interpreter=new s.default(this),this.logger=e}run(e){this.source=e;const n=new a.default(e,{error:(e,n)=>this.error(e,n)}),t=n.scanTokens(),o=new r.default(t,{error:(e,n)=>this.errorToken(e,n)}),i=o.parse();if(!this.hadError){const e=new l.default(this.interpreter,this);e.resolve(i),this.hadError||this.interpreter.interpret(i)}}error(e,n){const{line:t,column:r}=o.locate(this.source,e,p);this.reportError(t,r,'',n)}errorToken(e,n){const{line:t,column:r}=o.locate(this.source,e.start,p);e.type===i.TokenType.EOF?this.reportError(t,r,'at end',n):this.reportError(t,r,`at "${e.lexeme}"`,n)}runtimeError(e){const{line:n,column:t}=o.locate(this.source,e.token.start,p);this.logger.error(`[${n}:${t}] ${e.message}`),this.hadRuntimeError=!0}reportError(e,n,t,o){this.logger.error(`[${e}:${n}] Error ${t}: ${o}`),this.hadError=!0}}},function(e,n,t){'use strict';Object.defineProperty(n,'__esModule',{value:!0});const o=t(7),r=t(1),a=t(3);class i{}n.LoxCallable=i;class s extends i{constructor(e,n,t,o){super(),this.name=e,this.declaration=n,this.closure=t,this.isInitilizer=o}get arity(){return this.declaration.parameter.length}call(e,n){const t=new o.default(this.closure);for(let o=0;o<this.arity;o++)t.define(this.declaration.parameter[o].lexeme,n[o]);const i=new a.Block(this.declaration.body);try{e.executeBlock(i,t)}catch(e){if(e instanceof r.ReturnException)return e.value;throw e}if(this.isInitilizer)return t.getAt(0,'this')}bind(e){const n=new o.default(this.closure);return n.define('this',e),new s(this.name,this.declaration,n,this.isInitilizer)}toString(){return`<fn ${this.name||'anonymous'}>`}}n.LoxFunction=s},function(e,n,t){'use strict';Object.defineProperty(n,'__esModule',{value:!0});const o=t(1);class r{constructor(e){this.fields=new Map,this.klass=e}get(e){if(this.klass){if(this.fields.has(e.lexeme))return this.fields.get(e.lexeme);const n=this.klass.findMethod(this,e);if(n)return n;throw new o.RuntimeException(e,`Undefined property ${e.lexeme}.`)}}set(e,n){this.fields.set(e.lexeme,n)}toString(){return this.klass?`<Instance ${this.klass.name}>`:void 0}}n.LoxInstance=r;class a extends r{constructor(e,n,t){super(e),this.name=n,this.methods=t}call(e,n){const t=new r(this),o=this.methods.init;return o&&o.bind(t).call(e,n),t}findMethod(e,n){if(n.lexeme in this.methods)return this.methods[n.lexeme].bind(e)}get arity(){const e=this.methods.init;return e?e.arity:0}toString(){return`<Class ${this.name}>`}}n.LoxClass=a},function(e,n,t){'use strict';Object.defineProperty(n,'__esModule',{value:!0});const o=t(0);var r;(function(e){e[e.DECLARED=0]='DECLARED',e[e.DEFINED=1]='DEFINED',e[e.READ=2]='READ'})(r||(r={}));var a;(function(e){e[e.NONE=0]='NONE',e[e.FUNCTION=1]='FUNCTION',e[e.METHOD=2]='METHOD',e[e.INITIALIZER=3]='INITIALIZER'})(a||(a={}));var i;(function(e){e[e.NONE=0]='NONE',e[e.CLASS=1]='CLASS'})(i||(i={}));n.default=class{constructor(e,n){this.scopes=[],this.functionType=a.NONE,this.classType=i.NONE,this.runner=n,this.interpreter=e}visitBlockStmt(e){this.beginScope(),this.resolve(e.statements);const n=this.endScope();for(let t of n.values())t.state<r.READ&&t.name.type!==o.TokenType.THIS&&this.runner.errorToken(t.name,'Unused variable.')}visitFunctionStmt(e){this.declare(e.name),this.define(e.name),this.resolveFunction(e.fn,a.FUNCTION)}visitFunctionExpr(e){this.resolveFunction(e,a.FUNCTION)}visitVarStmt(e){this.declare(e.name),e.initializer&&this.resolveExpr(e.initializer),this.define(e.name)}visitVariableExpr(e){if(this.scopes.length){const n=this.currentScope().get(e.name.lexeme);n&&n.state===r.DECLARED&&this.runner.errorToken(e.name,'Cannot read variable before own init.')}this.resolveLocal(e,e.name,!0)}visitAssignExpr(e){this.resolveExpr(e.value),this.resolveLocal(e,e.name,!1)}visitGetExpr(e){this.resolveExpr(e.object)}visitSetExpr(e){this.resolveExpr(e.value),this.resolveExpr(e.object)}visitClassStmt(e){const n=this.classType;this.classType=i.CLASS,this.declare(e.name);for(let n of e.methods){this.beginScope(),this.currentScope().set('this',{name:new o.default(o.TokenType.THIS,'this',void 0,e.name.start),state:r.DEFINED});let t=a.METHOD;'init'===n.name.lexeme&&(t=a.INITIALIZER),this.resolveFunction(n.fn,t),this.endScope()}for(let n of e.classMethods)this.beginScope(),this.currentScope().set('this',{name:new o.default(o.TokenType.THIS,'this',void 0,e.name.start),state:r.DEFINED}),this.resolveFunction(n.fn,a.METHOD),this.endScope();this.define(e.name),this.classType=n}visitThisExpr(e){this.classType!==i.CLASS&&this.runner.errorToken(e.keyword,'Can only be used in class methods.'),this.resolveLocal(e,e.keyword,!0)}visitExpressionStmt(e){this.resolveExpr(e.expr)}visitIfStmt(e){this.resolveExpr(e.condition),this.resolveStmt(e.thenBranch),e.elseBranch&&this.resolveStmt(e.elseBranch)}visitPrintStmt(e){this.resolveExpr(e.expr)}visitReturnStmt(e){this.functionType===a.NONE?this.runner.errorToken(e.keyword,'Cannot return from top level.'):this.functionType===a.INITIALIZER&&this.runner.errorToken(e.keyword,'Cannot return a value from the intializer.'),this.resolveExpr(e.value)}visitWhileStmt(e){this.resolveExpr(e.condition),this.resolveStmt(e.body)}visitBinaryExpr(e){this.resolveExpr(e.left),this.resolveExpr(e.right)}visitCallExpr(e){this.resolveExpr(e.callee);for(let n of e.args)this.resolveExpr(n)}visitGroupingExpr(e){this.resolveExpr(e.expr)}visitLiteralExpr(){}visitLogicalExpr(e){this.resolveExpr(e.left),this.resolveExpr(e.right)}visitUnaryExpr(e){this.resolveExpr(e.right)}visitBreakStmt(){}beginScope(){this.scopes.push(new Map)}endScope(){return this.scopes.pop()}declare(e){if(this.scopes.length){const n=this.currentScope();n.has(e.lexeme)&&this.runner.errorToken(e,'Duplicate variable declaration in the scope.'),n.set(e.lexeme,{name:e,state:r.DECLARED})}}define(e){this.scopes.length&&this.currentScope().set(e.lexeme,{name:e,state:r.DEFINED})}currentScope(){return this.scopes[this.scopes.length-1]}resolveFunction(e,n){const t=this.functionType;this.functionType=n,this.beginScope();for(let t of e.parameter)this.declare(t),this.define(t);this.resolve(e.body),this.endScope(),this.functionType=t}resolveLocal(e,n){for(let t=this.scopes.length-1;0<=t;t--)this.scopes[t].has(n.lexeme)&&(this.interpreter.resolve(e,this.scopes.length-1-t),this.scopes[t].get(n.lexeme).state=r.READ)}resolve(e){for(let n of e)this.resolveStmt(n)}resolveStmt(e){e.accept(this)}resolveExpr(e){e.accept(this)}}}]);
//# sourceMappingURL=main.5009a11f159c5161f5f0.js.map